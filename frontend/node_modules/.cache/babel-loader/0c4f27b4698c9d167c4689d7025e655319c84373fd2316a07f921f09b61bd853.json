{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { getAmplifyUserAgent } from '@aws-amplify/core';\nimport { getDnsSuffix, jitteredBackoff, getRetryDecider } from '@aws-amplify/core/internals/aws-client-utils';\nimport { parseXmlError } from './utils';\nvar DOMAIN_PATTERN = /^[a-z0-9][a-z0-9\\.\\-]{1,61}[a-z0-9]$/;\nvar IP_ADDRESS_PATTERN = /(\\d+\\.){3}\\d+/;\nvar DOTS_PATTERN = /\\.\\./;\n/**\n * The service name used to sign requests if the API requires authentication.\n */\nexport var SERVICE_NAME = 's3';\n/**\n * The endpoint resolver function that returns the endpoint URL for a given region, and input parameters.\n */\nvar endpointResolver = function (options, apiInput) {\n  var region = options.region,\n    useAccelerateEndpoint = options.useAccelerateEndpoint,\n    customEndpoint = options.customEndpoint,\n    forcePathStyle = options.forcePathStyle;\n  var endpoint;\n  // 1. get base endpoint\n  if (customEndpoint) {\n    endpoint = new URL(customEndpoint);\n  } else if (useAccelerateEndpoint) {\n    if (forcePathStyle) {\n      throw new Error('Path style URLs are not supported with S3 Transfer Acceleration.');\n    }\n    endpoint = new URL(\"https://s3-accelerate.\".concat(getDnsSuffix(region)));\n  } else {\n    endpoint = new URL(\"https://s3.\".concat(region, \".\").concat(getDnsSuffix(region)));\n  }\n  // 2. inject bucket name\n  if (apiInput === null || apiInput === void 0 ? void 0 : apiInput.Bucket) {\n    if (!isDnsCompatibleBucketName(apiInput.Bucket)) {\n      throw new Error(\"Invalid bucket name: \\\"\".concat(apiInput.Bucket, \"\\\".\"));\n    }\n    if (forcePathStyle || apiInput.Bucket.includes('.')) {\n      endpoint.pathname = \"/\".concat(apiInput.Bucket);\n    } else {\n      endpoint.host = \"\".concat(apiInput.Bucket, \".\").concat(endpoint.host);\n    }\n  }\n  return {\n    url: endpoint\n  };\n};\n/**\n * Determines whether a given string is DNS compliant per the rules outlined by\n * S3. Length, capitaization, and leading dot restrictions are enforced by the\n * DOMAIN_PATTERN regular expression.\n * @internal\n *\n * @see https://github.com/aws/aws-sdk-js-v3/blob/f2da6182298d4d6b02e84fb723492c07c27469a8/packages/middleware-bucket-endpoint/src/bucketHostnameUtils.ts#L39-L48\n * @see https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html\n */\nexport var isDnsCompatibleBucketName = function (bucketName) {\n  return DOMAIN_PATTERN.test(bucketName) && !IP_ADDRESS_PATTERN.test(bucketName) && !DOTS_PATTERN.test(bucketName);\n};\n/**\n * @internal\n */\nexport var defaultConfig = {\n  service: SERVICE_NAME,\n  endpointResolver: endpointResolver,\n  retryDecider: getRetryDecider(parseXmlError),\n  computeDelay: jitteredBackoff,\n  userAgentValue: getAmplifyUserAgent(),\n  useAccelerateEndpoint: false,\n  uriEscapePath: false // Required by S3. See https://github.com/aws/aws-sdk-js-v3/blob/9ba012dfa3a3429aa2db0f90b3b0b3a7a31f9bc3/packages/signature-v4/src/SignatureV4.ts#L76-L83\n};","map":{"version":3,"names":["getAmplifyUserAgent","getDnsSuffix","jitteredBackoff","getRetryDecider","parseXmlError","DOMAIN_PATTERN","IP_ADDRESS_PATTERN","DOTS_PATTERN","SERVICE_NAME","endpointResolver","options","apiInput","region","useAccelerateEndpoint","customEndpoint","forcePathStyle","endpoint","URL","Error","concat","Bucket","isDnsCompatibleBucketName","includes","pathname","host","url","bucketName","test","defaultConfig","service","retryDecider","computeDelay","userAgentValue","uriEscapePath"],"sources":["/Users/yannellym/Desktop/iwantapet/node_modules/@aws-amplify/storage/lib-esm/AwsClients/S3/base.js"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { getAmplifyUserAgent } from '@aws-amplify/core';\nimport { getDnsSuffix, jitteredBackoff, getRetryDecider, } from '@aws-amplify/core/internals/aws-client-utils';\nimport { parseXmlError } from './utils';\nvar DOMAIN_PATTERN = /^[a-z0-9][a-z0-9\\.\\-]{1,61}[a-z0-9]$/;\nvar IP_ADDRESS_PATTERN = /(\\d+\\.){3}\\d+/;\nvar DOTS_PATTERN = /\\.\\./;\n/**\n * The service name used to sign requests if the API requires authentication.\n */\nexport var SERVICE_NAME = 's3';\n/**\n * The endpoint resolver function that returns the endpoint URL for a given region, and input parameters.\n */\nvar endpointResolver = function (options, apiInput) {\n    var region = options.region, useAccelerateEndpoint = options.useAccelerateEndpoint, customEndpoint = options.customEndpoint, forcePathStyle = options.forcePathStyle;\n    var endpoint;\n    // 1. get base endpoint\n    if (customEndpoint) {\n        endpoint = new URL(customEndpoint);\n    }\n    else if (useAccelerateEndpoint) {\n        if (forcePathStyle) {\n            throw new Error('Path style URLs are not supported with S3 Transfer Acceleration.');\n        }\n        endpoint = new URL(\"https://s3-accelerate.\".concat(getDnsSuffix(region)));\n    }\n    else {\n        endpoint = new URL(\"https://s3.\".concat(region, \".\").concat(getDnsSuffix(region)));\n    }\n    // 2. inject bucket name\n    if (apiInput === null || apiInput === void 0 ? void 0 : apiInput.Bucket) {\n        if (!isDnsCompatibleBucketName(apiInput.Bucket)) {\n            throw new Error(\"Invalid bucket name: \\\"\".concat(apiInput.Bucket, \"\\\".\"));\n        }\n        if (forcePathStyle || apiInput.Bucket.includes('.')) {\n            endpoint.pathname = \"/\".concat(apiInput.Bucket);\n        }\n        else {\n            endpoint.host = \"\".concat(apiInput.Bucket, \".\").concat(endpoint.host);\n        }\n    }\n    return { url: endpoint };\n};\n/**\n * Determines whether a given string is DNS compliant per the rules outlined by\n * S3. Length, capitaization, and leading dot restrictions are enforced by the\n * DOMAIN_PATTERN regular expression.\n * @internal\n *\n * @see https://github.com/aws/aws-sdk-js-v3/blob/f2da6182298d4d6b02e84fb723492c07c27469a8/packages/middleware-bucket-endpoint/src/bucketHostnameUtils.ts#L39-L48\n * @see https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html\n */\nexport var isDnsCompatibleBucketName = function (bucketName) {\n    return DOMAIN_PATTERN.test(bucketName) &&\n        !IP_ADDRESS_PATTERN.test(bucketName) &&\n        !DOTS_PATTERN.test(bucketName);\n};\n/**\n * @internal\n */\nexport var defaultConfig = {\n    service: SERVICE_NAME,\n    endpointResolver: endpointResolver,\n    retryDecider: getRetryDecider(parseXmlError),\n    computeDelay: jitteredBackoff,\n    userAgentValue: getAmplifyUserAgent(),\n    useAccelerateEndpoint: false,\n    uriEscapePath: false, // Required by S3. See https://github.com/aws/aws-sdk-js-v3/blob/9ba012dfa3a3429aa2db0f90b3b0b3a7a31f9bc3/packages/signature-v4/src/SignatureV4.ts#L76-L83\n};\n"],"mappings":"AAAA;AACA;AACA,SAASA,mBAAmB,QAAQ,mBAAmB;AACvD,SAASC,YAAY,EAAEC,eAAe,EAAEC,eAAe,QAAS,8CAA8C;AAC9G,SAASC,aAAa,QAAQ,SAAS;AACvC,IAAIC,cAAc,GAAG,sCAAsC;AAC3D,IAAIC,kBAAkB,GAAG,eAAe;AACxC,IAAIC,YAAY,GAAG,MAAM;AACzB;AACA;AACA;AACA,OAAO,IAAIC,YAAY,GAAG,IAAI;AAC9B;AACA;AACA;AACA,IAAIC,gBAAgB,GAAG,SAAAA,CAAUC,OAAO,EAAEC,QAAQ,EAAE;EAChD,IAAIC,MAAM,GAAGF,OAAO,CAACE,MAAM;IAAEC,qBAAqB,GAAGH,OAAO,CAACG,qBAAqB;IAAEC,cAAc,GAAGJ,OAAO,CAACI,cAAc;IAAEC,cAAc,GAAGL,OAAO,CAACK,cAAc;EACpK,IAAIC,QAAQ;EACZ;EACA,IAAIF,cAAc,EAAE;IAChBE,QAAQ,GAAG,IAAIC,GAAG,CAACH,cAAc,CAAC;EACtC,CAAC,MACI,IAAID,qBAAqB,EAAE;IAC5B,IAAIE,cAAc,EAAE;MAChB,MAAM,IAAIG,KAAK,CAAC,kEAAkE,CAAC;IACvF;IACAF,QAAQ,GAAG,IAAIC,GAAG,CAAC,wBAAwB,CAACE,MAAM,CAAClB,YAAY,CAACW,MAAM,CAAC,CAAC,CAAC;EAC7E,CAAC,MACI;IACDI,QAAQ,GAAG,IAAIC,GAAG,CAAC,aAAa,CAACE,MAAM,CAACP,MAAM,EAAE,GAAG,CAAC,CAACO,MAAM,CAAClB,YAAY,CAACW,MAAM,CAAC,CAAC,CAAC;EACtF;EACA;EACA,IAAID,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAACS,MAAM,EAAE;IACrE,IAAI,CAACC,yBAAyB,CAACV,QAAQ,CAACS,MAAM,CAAC,EAAE;MAC7C,MAAM,IAAIF,KAAK,CAAC,yBAAyB,CAACC,MAAM,CAACR,QAAQ,CAACS,MAAM,EAAE,KAAK,CAAC,CAAC;IAC7E;IACA,IAAIL,cAAc,IAAIJ,QAAQ,CAACS,MAAM,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;MACjDN,QAAQ,CAACO,QAAQ,GAAG,GAAG,CAACJ,MAAM,CAACR,QAAQ,CAACS,MAAM,CAAC;IACnD,CAAC,MACI;MACDJ,QAAQ,CAACQ,IAAI,GAAG,EAAE,CAACL,MAAM,CAACR,QAAQ,CAACS,MAAM,EAAE,GAAG,CAAC,CAACD,MAAM,CAACH,QAAQ,CAACQ,IAAI,CAAC;IACzE;EACJ;EACA,OAAO;IAAEC,GAAG,EAAET;EAAS,CAAC;AAC5B,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,IAAIK,yBAAyB,GAAG,SAAAA,CAAUK,UAAU,EAAE;EACzD,OAAOrB,cAAc,CAACsB,IAAI,CAACD,UAAU,CAAC,IAClC,CAACpB,kBAAkB,CAACqB,IAAI,CAACD,UAAU,CAAC,IACpC,CAACnB,YAAY,CAACoB,IAAI,CAACD,UAAU,CAAC;AACtC,CAAC;AACD;AACA;AACA;AACA,OAAO,IAAIE,aAAa,GAAG;EACvBC,OAAO,EAAErB,YAAY;EACrBC,gBAAgB,EAAEA,gBAAgB;EAClCqB,YAAY,EAAE3B,eAAe,CAACC,aAAa,CAAC;EAC5C2B,YAAY,EAAE7B,eAAe;EAC7B8B,cAAc,EAAEhC,mBAAmB,CAAC,CAAC;EACrCa,qBAAqB,EAAE,KAAK;EAC5BoB,aAAa,EAAE,KAAK,CAAE;AAC1B,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}