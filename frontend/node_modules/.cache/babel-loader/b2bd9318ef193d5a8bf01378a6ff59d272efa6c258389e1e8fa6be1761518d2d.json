{"ast":null,"code":"var _s2 = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport usePetFinderAPI from './usePetFinderAPI';\nfunction useAnimalsBasedOnPreferencesAPI(preferences) {\n  _s2();\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    var _s = $RefreshSig$();\n    const fetchAnimalsBasedOnPreferences = async () => {\n      _s();\n      try {\n        let filteredAnimals = [];\n        let apiCallsMade = 0;\n        while (apiCallsMade < 2 && filteredAnimals.length === 0) {\n          const gender = preferences.gender !== 'any' ? preferences.gender : 'Male';\n          const size = preferences.size !== 'any' ? preferences.size : 'Large';\n          const apiUrl = `http://localhost:3002/api/petfinder?perPage=100&type=${preferences.type}&gender=${gender}&age=${preferences.age}&size=${size}`;\n\n          // Use the usePetfinderAPI hook to fetch data\n          const {\n            data: prefdata,\n            loading: prefdataLoading\n          } = usePetFinderAPI(apiUrl, []);\n          if (prefdata && prefdata.animals) {\n            filteredAnimals = prefdata.animals.filter(animal => {\n              const matchesTags = preferences.temperament.some(prefTemperament => animal.tags.includes(prefTemperament));\n              return matchesTags || preferences.temperament.length === 0;\n            });\n            if (filteredAnimals.length === 0) {\n              apiCallsMade++;\n            }\n          }\n        }\n        if (filteredAnimals.length === 0) {\n          const type = preferences.type;\n          const gender = preferences.gender !== 'any' ? preferences.gender : 'Male';\n          const fallbackApiUrl = `http://localhost:3002/api/petfinder?perPage=1&type=${type}&gender=${gender}`;\n\n          // Use the usePetfinderAPI hook to fetch the fallback animal\n          const {\n            data: animalData,\n            loading: animalDataLoading\n          } = usePetFinderAPI(fallbackApiUrl, []);\n          if (animalData && animalData.animals && animalData.animals.length > 0) {\n            const matchedAnimal = animalData.animals[0];\n            filteredAnimals.push(matchedAnimal);\n          } else {\n            console.log(\"No matching animal found based on type and gender or age.\");\n          }\n        }\n        setData(filteredAnimals);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching pet data:', error);\n        setLoading(false);\n      }\n    };\n    _s(fetchAnimalsBasedOnPreferences, \"i2VE1HGklmykpMwsIIucxAQ76Xs=\", false, function () {\n      return [usePetFinderAPI, usePetFinderAPI];\n    });\n    fetchAnimalsBasedOnPreferences();\n  }, [preferences]);\n  return {\n    data,\n    loading\n  };\n}\n_s2(useAnimalsBasedOnPreferencesAPI, \"Zn4cs3026OJRBhxLd0Oqj+bUOXY=\");\nexport default useAnimalsBasedOnPreferencesAPI;","map":{"version":3,"names":["useEffect","useState","usePetFinderAPI","useAnimalsBasedOnPreferencesAPI","preferences","_s2","data","setData","loading","setLoading","_s","$RefreshSig$","fetchAnimalsBasedOnPreferences","filteredAnimals","apiCallsMade","length","gender","size","apiUrl","type","age","prefdata","prefdataLoading","animals","filter","animal","matchesTags","temperament","some","prefTemperament","tags","includes","fallbackApiUrl","animalData","animalDataLoading","matchedAnimal","push","console","log","error"],"sources":["/Users/yannellym/Desktop/iwantapet/frontend/src/components/useAnimalsBasedOnPreferencesAPI.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport usePetFinderAPI from './usePetFinderAPI';\n\nfunction useAnimalsBasedOnPreferencesAPI(preferences) {\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchAnimalsBasedOnPreferences = async () => {\n      try {\n        let filteredAnimals = [];\n        let apiCallsMade = 0;\n\n        while (apiCallsMade < 2 && filteredAnimals.length === 0) {\n          const gender = preferences.gender !== 'any' ? preferences.gender : 'Male';\n          const size = preferences.size !== 'any' ? preferences.size : 'Large';\n          const apiUrl = `http://localhost:3002/api/petfinder?perPage=100&type=${preferences.type}&gender=${gender}&age=${preferences.age}&size=${size}`;\n\n          // Use the usePetfinderAPI hook to fetch data\n          const { data: prefdata, loading: prefdataLoading } = usePetFinderAPI(apiUrl, []);\n\n          if (prefdata && prefdata.animals) {\n            filteredAnimals = prefdata.animals.filter((animal) => {\n              const matchesTags = preferences.temperament.some((prefTemperament) => animal.tags.includes(prefTemperament));\n              return (matchesTags || preferences.temperament.length === 0);\n            });\n            if (filteredAnimals.length === 0) {\n              apiCallsMade++;\n            }\n          }\n        }\n\n        if (filteredAnimals.length === 0) {\n          const type = preferences.type;\n          const gender = preferences.gender !== 'any' ? preferences.gender : 'Male';\n          const fallbackApiUrl = `http://localhost:3002/api/petfinder?perPage=1&type=${type}&gender=${gender}`;\n\n          // Use the usePetfinderAPI hook to fetch the fallback animal\n          const { data: animalData, loading: animalDataLoading } = usePetFinderAPI(fallbackApiUrl, []);\n\n          if (animalData && animalData.animals && animalData.animals.length > 0) {\n            const matchedAnimal = animalData.animals[0];\n            filteredAnimals.push(matchedAnimal);\n          } else {\n            console.log(\"No matching animal found based on type and gender or age.\");\n          }\n        }\n\n        setData(filteredAnimals);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching pet data:', error);\n        setLoading(false);\n      }\n    };\n\n    fetchAnimalsBasedOnPreferences();\n  }, [preferences]);\n\n  return { data, loading };\n}\n\nexport default useAnimalsBasedOnPreferencesAPI;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}