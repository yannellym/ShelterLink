{"ast":null,"code":"import { __awaiter, __generator, __values } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { normalizeProvider } from \"@aws-sdk/util-middleware\";\nimport { ALGORITHM_IDENTIFIER, ALGORITHM_QUERY_PARAM, AMZ_DATE_HEADER, AMZ_DATE_QUERY_PARAM, AUTH_HEADER, CREDENTIAL_QUERY_PARAM, EVENT_ALGORITHM_IDENTIFIER, EXPIRES_QUERY_PARAM, MAX_PRESIGNED_TTL, SHA256_HEADER, SIGNATURE_QUERY_PARAM, SIGNED_HEADERS_QUERY_PARAM, TOKEN_HEADER, TOKEN_QUERY_PARAM } from \"./constants\";\nimport { createScope, getSigningKey } from \"./credentialDerivation\";\nimport { getCanonicalHeaders } from \"./getCanonicalHeaders\";\nimport { getCanonicalQuery } from \"./getCanonicalQuery\";\nimport { getPayloadHash } from \"./getPayloadHash\";\nimport { hasHeader } from \"./headerUtil\";\nimport { moveHeadersToQuery } from \"./moveHeadersToQuery\";\nimport { prepareRequest } from \"./prepareRequest\";\nimport { iso8601 } from \"./utilDate\";\nvar SignatureV4 = function () {\n  function SignatureV4(_a) {\n    var applyChecksum = _a.applyChecksum,\n      credentials = _a.credentials,\n      region = _a.region,\n      service = _a.service,\n      sha256 = _a.sha256,\n      _b = _a.uriEscapePath,\n      uriEscapePath = _b === void 0 ? true : _b;\n    this.service = service;\n    this.sha256 = sha256;\n    this.uriEscapePath = uriEscapePath;\n    this.applyChecksum = typeof applyChecksum === \"boolean\" ? applyChecksum : true;\n    this.regionProvider = normalizeProvider(region);\n    this.credentialProvider = normalizeProvider(credentials);\n  }\n  SignatureV4.prototype.presign = function (originalRequest, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, signingDate, _b, expiresIn, unsignableHeaders, unhoistableHeaders, signableHeaders, signingRegion, signingService, credentials, region, _c, _d, longDate, shortDate, scope, request, canonicalHeaders, _e, _f, _g, _h, _j, _k;\n      return __generator(this, function (_l) {\n        switch (_l.label) {\n          case 0:\n            _a = options.signingDate, signingDate = _a === void 0 ? new Date() : _a, _b = options.expiresIn, expiresIn = _b === void 0 ? 3600 : _b, unsignableHeaders = options.unsignableHeaders, unhoistableHeaders = options.unhoistableHeaders, signableHeaders = options.signableHeaders, signingRegion = options.signingRegion, signingService = options.signingService;\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _l.sent();\n            this.validateResolvedCredentials(credentials);\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _c = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _c = _l.sent();\n            _l.label = 4;\n          case 4:\n            region = _c;\n            _d = formatDate(signingDate), longDate = _d.longDate, shortDate = _d.shortDate;\n            if (expiresIn > MAX_PRESIGNED_TTL) {\n              return [2, Promise.reject(\"Signature version 4 presigned URLs\" + \" must have an expiration date less than one week in\" + \" the future\")];\n            }\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            request = moveHeadersToQuery(prepareRequest(originalRequest), {\n              unhoistableHeaders: unhoistableHeaders\n            });\n            if (credentials.sessionToken) {\n              request.query[TOKEN_QUERY_PARAM] = credentials.sessionToken;\n            }\n            request.query[ALGORITHM_QUERY_PARAM] = ALGORITHM_IDENTIFIER;\n            request.query[CREDENTIAL_QUERY_PARAM] = \"\".concat(credentials.accessKeyId, \"/\").concat(scope);\n            request.query[AMZ_DATE_QUERY_PARAM] = longDate;\n            request.query[EXPIRES_QUERY_PARAM] = expiresIn.toString(10);\n            canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n            request.query[SIGNED_HEADERS_QUERY_PARAM] = getCanonicalHeaderList(canonicalHeaders);\n            _e = request.query;\n            _f = SIGNATURE_QUERY_PARAM;\n            _g = this.getSignature;\n            _h = [longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService)];\n            _j = this.createCanonicalRequest;\n            _k = [request, canonicalHeaders];\n            return [4, getPayloadHash(originalRequest, this.sha256)];\n          case 5:\n            return [4, _g.apply(this, _h.concat([_j.apply(this, _k.concat([_l.sent()]))]))];\n          case 6:\n            _e[_f] = _l.sent();\n            return [2, request];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.sign = function (toSign, options) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (typeof toSign === \"string\") {\n          return [2, this.signString(toSign, options)];\n        } else if (toSign.headers && toSign.payload) {\n          return [2, this.signEvent(toSign, options)];\n        } else {\n          return [2, this.signRequest(toSign, options)];\n        }\n        return [2];\n      });\n    });\n  };\n  SignatureV4.prototype.signEvent = function (_a, _b) {\n    var headers = _a.headers,\n      payload = _a.payload;\n    var _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      priorSignature = _b.priorSignature,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var region, _d, _e, shortDate, longDate, scope, hashedPayload, hash, hashedHeaders, _f, stringToSign;\n      return __generator(this, function (_g) {\n        switch (_g.label) {\n          case 0:\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 1];\n            _d = signingRegion;\n            return [3, 3];\n          case 1:\n            return [4, this.regionProvider()];\n          case 2:\n            _d = _g.sent();\n            _g.label = 3;\n          case 3:\n            region = _d;\n            _e = formatDate(signingDate), shortDate = _e.shortDate, longDate = _e.longDate;\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            return [4, getPayloadHash({\n              headers: {},\n              body: payload\n            }, this.sha256)];\n          case 4:\n            hashedPayload = _g.sent();\n            hash = new this.sha256();\n            hash.update(headers);\n            _f = toHex;\n            return [4, hash.digest()];\n          case 5:\n            hashedHeaders = _f.apply(void 0, [_g.sent()]);\n            stringToSign = [EVENT_ALGORITHM_IDENTIFIER, longDate, scope, priorSignature, hashedHeaders, hashedPayload].join(\"\\n\");\n            return [2, this.signString(stringToSign, {\n              signingDate: signingDate,\n              signingRegion: region,\n              signingService: signingService\n            })];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.signString = function (stringToSign, _a) {\n    var _b = _a === void 0 ? {} : _a,\n      _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var credentials, region, _d, shortDate, hash, _e, _f, _g;\n      return __generator(this, function (_h) {\n        switch (_h.label) {\n          case 0:\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _h.sent();\n            this.validateResolvedCredentials(credentials);\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _d = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _d = _h.sent();\n            _h.label = 4;\n          case 4:\n            region = _d;\n            shortDate = formatDate(signingDate).shortDate;\n            _f = (_e = this.sha256).bind;\n            return [4, this.getSigningKey(credentials, region, shortDate, signingService)];\n          case 5:\n            hash = new (_f.apply(_e, [void 0, _h.sent()]))();\n            hash.update(stringToSign);\n            _g = toHex;\n            return [4, hash.digest()];\n          case 6:\n            return [2, _g.apply(void 0, [_h.sent()])];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.signRequest = function (requestToSign, _a) {\n    var _b = _a === void 0 ? {} : _a,\n      _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      signableHeaders = _b.signableHeaders,\n      unsignableHeaders = _b.unsignableHeaders,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var credentials, region, _d, request, _e, longDate, shortDate, scope, payloadHash, canonicalHeaders, signature;\n      return __generator(this, function (_f) {\n        switch (_f.label) {\n          case 0:\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _f.sent();\n            this.validateResolvedCredentials(credentials);\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _d = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _d = _f.sent();\n            _f.label = 4;\n          case 4:\n            region = _d;\n            request = prepareRequest(requestToSign);\n            _e = formatDate(signingDate), longDate = _e.longDate, shortDate = _e.shortDate;\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            request.headers[AMZ_DATE_HEADER] = longDate;\n            if (credentials.sessionToken) {\n              request.headers[TOKEN_HEADER] = credentials.sessionToken;\n            }\n            return [4, getPayloadHash(request, this.sha256)];\n          case 5:\n            payloadHash = _f.sent();\n            if (!hasHeader(SHA256_HEADER, request.headers) && this.applyChecksum) {\n              request.headers[SHA256_HEADER] = payloadHash;\n            }\n            canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n            return [4, this.getSignature(longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService), this.createCanonicalRequest(request, canonicalHeaders, payloadHash))];\n          case 6:\n            signature = _f.sent();\n            request.headers[AUTH_HEADER] = \"\".concat(ALGORITHM_IDENTIFIER, \" \") + \"Credential=\".concat(credentials.accessKeyId, \"/\").concat(scope, \", \") + \"SignedHeaders=\".concat(getCanonicalHeaderList(canonicalHeaders), \", \") + \"Signature=\".concat(signature);\n            return [2, request];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.createCanonicalRequest = function (request, canonicalHeaders, payloadHash) {\n    var sortedHeaders = Object.keys(canonicalHeaders).sort();\n    return \"\".concat(request.method, \"\\n\").concat(this.getCanonicalPath(request), \"\\n\").concat(getCanonicalQuery(request), \"\\n\").concat(sortedHeaders.map(function (name) {\n      return \"\".concat(name, \":\").concat(canonicalHeaders[name]);\n    }).join(\"\\n\"), \"\\n\\n\").concat(sortedHeaders.join(\";\"), \"\\n\").concat(payloadHash);\n  };\n  SignatureV4.prototype.createStringToSign = function (longDate, credentialScope, canonicalRequest) {\n    return __awaiter(this, void 0, void 0, function () {\n      var hash, hashedRequest;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            hash = new this.sha256();\n            hash.update(canonicalRequest);\n            return [4, hash.digest()];\n          case 1:\n            hashedRequest = _a.sent();\n            return [2, \"\".concat(ALGORITHM_IDENTIFIER, \"\\n\").concat(longDate, \"\\n\").concat(credentialScope, \"\\n\").concat(toHex(hashedRequest))];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.getCanonicalPath = function (_a) {\n    var e_1, _b;\n    var path = _a.path;\n    if (this.uriEscapePath) {\n      var normalizedPathSegments = [];\n      try {\n        for (var _c = __values(path.split(\"/\")), _d = _c.next(); !_d.done; _d = _c.next()) {\n          var pathSegment = _d.value;\n          if ((pathSegment === null || pathSegment === void 0 ? void 0 : pathSegment.length) === 0) continue;\n          if (pathSegment === \".\") continue;\n          if (pathSegment === \"..\") {\n            normalizedPathSegments.pop();\n          } else {\n            normalizedPathSegments.push(pathSegment);\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n      var normalizedPath = \"\".concat((path === null || path === void 0 ? void 0 : path.startsWith(\"/\")) ? \"/\" : \"\").concat(normalizedPathSegments.join(\"/\")).concat(normalizedPathSegments.length > 0 && (path === null || path === void 0 ? void 0 : path.endsWith(\"/\")) ? \"/\" : \"\");\n      var doubleEncoded = encodeURIComponent(normalizedPath);\n      return doubleEncoded.replace(/%2F/g, \"/\");\n    }\n    return path;\n  };\n  SignatureV4.prototype.getSignature = function (longDate, credentialScope, keyPromise, canonicalRequest) {\n    return __awaiter(this, void 0, void 0, function () {\n      var stringToSign, hash, _a, _b, _c;\n      return __generator(this, function (_d) {\n        switch (_d.label) {\n          case 0:\n            return [4, this.createStringToSign(longDate, credentialScope, canonicalRequest)];\n          case 1:\n            stringToSign = _d.sent();\n            _b = (_a = this.sha256).bind;\n            return [4, keyPromise];\n          case 2:\n            hash = new (_b.apply(_a, [void 0, _d.sent()]))();\n            hash.update(stringToSign);\n            _c = toHex;\n            return [4, hash.digest()];\n          case 3:\n            return [2, _c.apply(void 0, [_d.sent()])];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.getSigningKey = function (credentials, region, shortDate, service) {\n    return getSigningKey(this.sha256, credentials, shortDate, region, service || this.service);\n  };\n  SignatureV4.prototype.validateResolvedCredentials = function (credentials) {\n    if (typeof credentials !== \"object\" || typeof credentials.accessKeyId !== \"string\" || typeof credentials.secretAccessKey !== \"string\") {\n      throw new Error(\"Resolved credential object is not valid\");\n    }\n  };\n  return SignatureV4;\n}();\nexport { SignatureV4 };\nvar formatDate = function (now) {\n  var longDate = iso8601(now).replace(/[\\-:]/g, \"\");\n  return {\n    longDate: longDate,\n    shortDate: longDate.slice(0, 8)\n  };\n};\nvar getCanonicalHeaderList = function (headers) {\n  return Object.keys(headers).sort().join(\";\");\n};","map":{"version":3,"names":["__awaiter","__generator","__values","toHex","normalizeProvider","ALGORITHM_IDENTIFIER","ALGORITHM_QUERY_PARAM","AMZ_DATE_HEADER","AMZ_DATE_QUERY_PARAM","AUTH_HEADER","CREDENTIAL_QUERY_PARAM","EVENT_ALGORITHM_IDENTIFIER","EXPIRES_QUERY_PARAM","MAX_PRESIGNED_TTL","SHA256_HEADER","SIGNATURE_QUERY_PARAM","SIGNED_HEADERS_QUERY_PARAM","TOKEN_HEADER","TOKEN_QUERY_PARAM","createScope","getSigningKey","getCanonicalHeaders","getCanonicalQuery","getPayloadHash","hasHeader","moveHeadersToQuery","prepareRequest","iso8601","SignatureV4","_a","applyChecksum","credentials","region","service","sha256","_b","uriEscapePath","regionProvider","credentialProvider","prototype","presign","originalRequest","options","signingDate","expiresIn","unsignableHeaders","unhoistableHeaders","signableHeaders","signingRegion","signingService","_c","_d","longDate","shortDate","scope","request","canonicalHeaders","_e","_f","_g","_h","_j","_k","_l","label","Date","sent","validateResolvedCredentials","formatDate","Promise","reject","sessionToken","query","concat","accessKeyId","toString","getCanonicalHeaderList","getSignature","createCanonicalRequest","apply","sign","toSign","signString","headers","payload","signEvent","signRequest","priorSignature","hashedPayload","hash","hashedHeaders","stringToSign","body","update","digest","join","bind","requestToSign","payloadHash","signature","sortedHeaders","Object","keys","sort","method","getCanonicalPath","map","name","createStringToSign","credentialScope","canonicalRequest","hashedRequest","e_1","path","normalizedPathSegments","split","next","done","pathSegment","value","length","pop","push","e_1_1","error","return","call","normalizedPath","startsWith","endsWith","doubleEncoded","encodeURIComponent","replace","keyPromise","secretAccessKey","Error","now","slice"],"sources":["/Users/yannellym/Desktop/iwantapet/node_modules/@aws-sdk/client-location/node_modules/@aws-sdk/signature-v4/dist-es/SignatureV4.js"],"sourcesContent":["import { __awaiter, __generator, __values } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { normalizeProvider } from \"@aws-sdk/util-middleware\";\nimport { ALGORITHM_IDENTIFIER, ALGORITHM_QUERY_PARAM, AMZ_DATE_HEADER, AMZ_DATE_QUERY_PARAM, AUTH_HEADER, CREDENTIAL_QUERY_PARAM, EVENT_ALGORITHM_IDENTIFIER, EXPIRES_QUERY_PARAM, MAX_PRESIGNED_TTL, SHA256_HEADER, SIGNATURE_QUERY_PARAM, SIGNED_HEADERS_QUERY_PARAM, TOKEN_HEADER, TOKEN_QUERY_PARAM, } from \"./constants\";\nimport { createScope, getSigningKey } from \"./credentialDerivation\";\nimport { getCanonicalHeaders } from \"./getCanonicalHeaders\";\nimport { getCanonicalQuery } from \"./getCanonicalQuery\";\nimport { getPayloadHash } from \"./getPayloadHash\";\nimport { hasHeader } from \"./headerUtil\";\nimport { moveHeadersToQuery } from \"./moveHeadersToQuery\";\nimport { prepareRequest } from \"./prepareRequest\";\nimport { iso8601 } from \"./utilDate\";\nvar SignatureV4 = (function () {\n    function SignatureV4(_a) {\n        var applyChecksum = _a.applyChecksum, credentials = _a.credentials, region = _a.region, service = _a.service, sha256 = _a.sha256, _b = _a.uriEscapePath, uriEscapePath = _b === void 0 ? true : _b;\n        this.service = service;\n        this.sha256 = sha256;\n        this.uriEscapePath = uriEscapePath;\n        this.applyChecksum = typeof applyChecksum === \"boolean\" ? applyChecksum : true;\n        this.regionProvider = normalizeProvider(region);\n        this.credentialProvider = normalizeProvider(credentials);\n    }\n    SignatureV4.prototype.presign = function (originalRequest, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, signingDate, _b, expiresIn, unsignableHeaders, unhoistableHeaders, signableHeaders, signingRegion, signingService, credentials, region, _c, _d, longDate, shortDate, scope, request, canonicalHeaders, _e, _f, _g, _h, _j, _k;\n            return __generator(this, function (_l) {\n                switch (_l.label) {\n                    case 0:\n                        _a = options.signingDate, signingDate = _a === void 0 ? new Date() : _a, _b = options.expiresIn, expiresIn = _b === void 0 ? 3600 : _b, unsignableHeaders = options.unsignableHeaders, unhoistableHeaders = options.unhoistableHeaders, signableHeaders = options.signableHeaders, signingRegion = options.signingRegion, signingService = options.signingService;\n                        return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _l.sent();\n                        this.validateResolvedCredentials(credentials);\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _c = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _c = (_l.sent());\n                        _l.label = 4;\n                    case 4:\n                        region = _c;\n                        _d = formatDate(signingDate), longDate = _d.longDate, shortDate = _d.shortDate;\n                        if (expiresIn > MAX_PRESIGNED_TTL) {\n                            return [2, Promise.reject(\"Signature version 4 presigned URLs\" + \" must have an expiration date less than one week in\" + \" the future\")];\n                        }\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        request = moveHeadersToQuery(prepareRequest(originalRequest), { unhoistableHeaders: unhoistableHeaders });\n                        if (credentials.sessionToken) {\n                            request.query[TOKEN_QUERY_PARAM] = credentials.sessionToken;\n                        }\n                        request.query[ALGORITHM_QUERY_PARAM] = ALGORITHM_IDENTIFIER;\n                        request.query[CREDENTIAL_QUERY_PARAM] = \"\".concat(credentials.accessKeyId, \"/\").concat(scope);\n                        request.query[AMZ_DATE_QUERY_PARAM] = longDate;\n                        request.query[EXPIRES_QUERY_PARAM] = expiresIn.toString(10);\n                        canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n                        request.query[SIGNED_HEADERS_QUERY_PARAM] = getCanonicalHeaderList(canonicalHeaders);\n                        _e = request.query;\n                        _f = SIGNATURE_QUERY_PARAM;\n                        _g = this.getSignature;\n                        _h = [longDate,\n                            scope,\n                            this.getSigningKey(credentials, region, shortDate, signingService)];\n                        _j = this.createCanonicalRequest;\n                        _k = [request, canonicalHeaders];\n                        return [4, getPayloadHash(originalRequest, this.sha256)];\n                    case 5: return [4, _g.apply(this, _h.concat([_j.apply(this, _k.concat([_l.sent()]))]))];\n                    case 6:\n                        _e[_f] = _l.sent();\n                        return [2, request];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.sign = function (toSign, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (typeof toSign === \"string\") {\n                    return [2, this.signString(toSign, options)];\n                }\n                else if (toSign.headers && toSign.payload) {\n                    return [2, this.signEvent(toSign, options)];\n                }\n                else {\n                    return [2, this.signRequest(toSign, options)];\n                }\n                return [2];\n            });\n        });\n    };\n    SignatureV4.prototype.signEvent = function (_a, _b) {\n        var headers = _a.headers, payload = _a.payload;\n        var _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, priorSignature = _b.priorSignature, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var region, _d, _e, shortDate, longDate, scope, hashedPayload, hash, hashedHeaders, _f, stringToSign;\n            return __generator(this, function (_g) {\n                switch (_g.label) {\n                    case 0:\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 1];\n                        _d = signingRegion;\n                        return [3, 3];\n                    case 1: return [4, this.regionProvider()];\n                    case 2:\n                        _d = (_g.sent());\n                        _g.label = 3;\n                    case 3:\n                        region = _d;\n                        _e = formatDate(signingDate), shortDate = _e.shortDate, longDate = _e.longDate;\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        return [4, getPayloadHash({ headers: {}, body: payload }, this.sha256)];\n                    case 4:\n                        hashedPayload = _g.sent();\n                        hash = new this.sha256();\n                        hash.update(headers);\n                        _f = toHex;\n                        return [4, hash.digest()];\n                    case 5:\n                        hashedHeaders = _f.apply(void 0, [_g.sent()]);\n                        stringToSign = [\n                            EVENT_ALGORITHM_IDENTIFIER,\n                            longDate,\n                            scope,\n                            priorSignature,\n                            hashedHeaders,\n                            hashedPayload,\n                        ].join(\"\\n\");\n                        return [2, this.signString(stringToSign, { signingDate: signingDate, signingRegion: region, signingService: signingService })];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.signString = function (stringToSign, _a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var credentials, region, _d, shortDate, hash, _e, _f, _g;\n            return __generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0: return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _h.sent();\n                        this.validateResolvedCredentials(credentials);\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _d = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _d = (_h.sent());\n                        _h.label = 4;\n                    case 4:\n                        region = _d;\n                        shortDate = formatDate(signingDate).shortDate;\n                        _f = (_e = this.sha256).bind;\n                        return [4, this.getSigningKey(credentials, region, shortDate, signingService)];\n                    case 5:\n                        hash = new (_f.apply(_e, [void 0, _h.sent()]))();\n                        hash.update(stringToSign);\n                        _g = toHex;\n                        return [4, hash.digest()];\n                    case 6: return [2, _g.apply(void 0, [_h.sent()])];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.signRequest = function (requestToSign, _a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, signableHeaders = _b.signableHeaders, unsignableHeaders = _b.unsignableHeaders, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var credentials, region, _d, request, _e, longDate, shortDate, scope, payloadHash, canonicalHeaders, signature;\n            return __generator(this, function (_f) {\n                switch (_f.label) {\n                    case 0: return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _f.sent();\n                        this.validateResolvedCredentials(credentials);\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _d = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _d = (_f.sent());\n                        _f.label = 4;\n                    case 4:\n                        region = _d;\n                        request = prepareRequest(requestToSign);\n                        _e = formatDate(signingDate), longDate = _e.longDate, shortDate = _e.shortDate;\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        request.headers[AMZ_DATE_HEADER] = longDate;\n                        if (credentials.sessionToken) {\n                            request.headers[TOKEN_HEADER] = credentials.sessionToken;\n                        }\n                        return [4, getPayloadHash(request, this.sha256)];\n                    case 5:\n                        payloadHash = _f.sent();\n                        if (!hasHeader(SHA256_HEADER, request.headers) && this.applyChecksum) {\n                            request.headers[SHA256_HEADER] = payloadHash;\n                        }\n                        canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n                        return [4, this.getSignature(longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService), this.createCanonicalRequest(request, canonicalHeaders, payloadHash))];\n                    case 6:\n                        signature = _f.sent();\n                        request.headers[AUTH_HEADER] =\n                            \"\".concat(ALGORITHM_IDENTIFIER, \" \") +\n                                \"Credential=\".concat(credentials.accessKeyId, \"/\").concat(scope, \", \") +\n                                \"SignedHeaders=\".concat(getCanonicalHeaderList(canonicalHeaders), \", \") +\n                                \"Signature=\".concat(signature);\n                        return [2, request];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.createCanonicalRequest = function (request, canonicalHeaders, payloadHash) {\n        var sortedHeaders = Object.keys(canonicalHeaders).sort();\n        return \"\".concat(request.method, \"\\n\").concat(this.getCanonicalPath(request), \"\\n\").concat(getCanonicalQuery(request), \"\\n\").concat(sortedHeaders.map(function (name) { return \"\".concat(name, \":\").concat(canonicalHeaders[name]); }).join(\"\\n\"), \"\\n\\n\").concat(sortedHeaders.join(\";\"), \"\\n\").concat(payloadHash);\n    };\n    SignatureV4.prototype.createStringToSign = function (longDate, credentialScope, canonicalRequest) {\n        return __awaiter(this, void 0, void 0, function () {\n            var hash, hashedRequest;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        hash = new this.sha256();\n                        hash.update(canonicalRequest);\n                        return [4, hash.digest()];\n                    case 1:\n                        hashedRequest = _a.sent();\n                        return [2, \"\".concat(ALGORITHM_IDENTIFIER, \"\\n\").concat(longDate, \"\\n\").concat(credentialScope, \"\\n\").concat(toHex(hashedRequest))];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.getCanonicalPath = function (_a) {\n        var e_1, _b;\n        var path = _a.path;\n        if (this.uriEscapePath) {\n            var normalizedPathSegments = [];\n            try {\n                for (var _c = __values(path.split(\"/\")), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var pathSegment = _d.value;\n                    if ((pathSegment === null || pathSegment === void 0 ? void 0 : pathSegment.length) === 0)\n                        continue;\n                    if (pathSegment === \".\")\n                        continue;\n                    if (pathSegment === \"..\") {\n                        normalizedPathSegments.pop();\n                    }\n                    else {\n                        normalizedPathSegments.push(pathSegment);\n                    }\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            var normalizedPath = \"\".concat((path === null || path === void 0 ? void 0 : path.startsWith(\"/\")) ? \"/\" : \"\").concat(normalizedPathSegments.join(\"/\")).concat(normalizedPathSegments.length > 0 && (path === null || path === void 0 ? void 0 : path.endsWith(\"/\")) ? \"/\" : \"\");\n            var doubleEncoded = encodeURIComponent(normalizedPath);\n            return doubleEncoded.replace(/%2F/g, \"/\");\n        }\n        return path;\n    };\n    SignatureV4.prototype.getSignature = function (longDate, credentialScope, keyPromise, canonicalRequest) {\n        return __awaiter(this, void 0, void 0, function () {\n            var stringToSign, hash, _a, _b, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4, this.createStringToSign(longDate, credentialScope, canonicalRequest)];\n                    case 1:\n                        stringToSign = _d.sent();\n                        _b = (_a = this.sha256).bind;\n                        return [4, keyPromise];\n                    case 2:\n                        hash = new (_b.apply(_a, [void 0, _d.sent()]))();\n                        hash.update(stringToSign);\n                        _c = toHex;\n                        return [4, hash.digest()];\n                    case 3: return [2, _c.apply(void 0, [_d.sent()])];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.getSigningKey = function (credentials, region, shortDate, service) {\n        return getSigningKey(this.sha256, credentials, shortDate, region, service || this.service);\n    };\n    SignatureV4.prototype.validateResolvedCredentials = function (credentials) {\n        if (typeof credentials !== \"object\" ||\n            typeof credentials.accessKeyId !== \"string\" ||\n            typeof credentials.secretAccessKey !== \"string\") {\n            throw new Error(\"Resolved credential object is not valid\");\n        }\n    };\n    return SignatureV4;\n}());\nexport { SignatureV4 };\nvar formatDate = function (now) {\n    var longDate = iso8601(now).replace(/[\\-:]/g, \"\");\n    return {\n        longDate: longDate,\n        shortDate: longDate.slice(0, 8),\n    };\n};\nvar getCanonicalHeaderList = function (headers) { return Object.keys(headers).sort().join(\";\"); };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}